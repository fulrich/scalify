<html><head><title>Scalify: Plus Play! Framework</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="fulrich" /><meta name="description" content="Build Shopify Apps using Scala" /><meta name="og:image" content="/scalify/img/poster.png" /><meta name="image" property="og:image" content="/scalify/img/poster.png" /><meta name="og:title" content="Scalify: Plus Play! Framework" /><meta name="title" property="og:title" content="Scalify: Plus Play! Framework" /><meta name="og:site_name" content="Scalify" /><meta name="og:url" content="https://fulrich.github.io/scalify/" /><meta name="og:type" content="website" /><meta name="og:description" content="Build Shopify Apps using Scala" /><link rel="icon" type="image/png" href="/scalify/img/favicon.png" /><meta name="twitter:title" content="Scalify: Plus Play! Framework" /><meta name="twitter:image" content="/scalify/img/poster.png" /><meta name="twitter:description" content="Build Shopify Apps using Scala" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/scalify/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/scalify/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/scalify/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/scalify/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/scalify/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/scalify/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/scalify/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/scalify/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/scalify/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/scalify/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/scalify/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/scalify/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/scalify/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/scalify/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/scalify/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/scalify/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/scalify/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/scalify/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/scalify/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/scalify/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/scalify/highlight/styles/darcula.css" /><link rel="stylesheet" href="/scalify/css/style.css" /><link rel="stylesheet" href="/scalify/css/palette.css" /><link rel="stylesheet" href="/scalify/css/codemirror.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/scalify/" class="brand"><div class="brand-wrapper"><span>Scalify</span></div></a></li> <li><a href="/scalify/docs/index.html" class="">Getting Started</a></li> <li><a href="/scalify/docs/core/index.html" class="">Scalify</a></li> <li><a href="/scalify/docs/plus/index.html" class="">Plus</a> <ul class="sub_section"> <li><a href="/scalify/docs/plus/play.html" class="">Play</a></li> <li><a href="/scalify/docs/plus/sbt-play.html" class="">SBT Play</a></li></ul></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/fulrich/scalify"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/fulrich/scalify"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li></ul></div></div></div></div><div id="content" data-github-owner="fulrich" data-github-repo="scalify"><div class="content-wrapper"><section><h2 id="plus-play-framework">Plus Play! Framework</h2>
<p>Scalify Plus Play! is meant to wrap Scalify to better integrate with the <a href="https://www.playframework.com/">Play! Framework</a>.
Add the Scalify Plus Play! library to your Play! Framework <code class="highlighter-rouge">build.sbt</code> along with core Scalify to being using the library.</p>

<p>You also need to enable the Scalify Plus Play! module in your configuration.
In your <code class="highlighter-rouge">.conf</code> file add the following line:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>play.modules.enabled += "com.github.fulrich.scalify.play.ScalifyModule"
</code></pre></div></div>

<h3 id="configuration">Configuration</h3>
<p>In the core Scalify documentation the <code class="highlighter-rouge">ShopifyConfiguration</code> object is discussed.
For Scalify Plus Play! this object is retrieved from Play!â€™s standard <a href="https://www.playframework.com/documentation/2.7.x/ConfigFile">configuration file</a>.</p>

<p>Scalify expects the config file to contain a section in the format below:</p>
<div class="language-hocon highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nl">shopify</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="nl">apiKey</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">"DEVELOPMENT_SHOPIFY_API_KEY"</span><span class="w">
  </span><span class="nl">apiSecret</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">"DEVELOPMENT_SHOPIFY_API_SECRET"</span><span class="w">
  </span><span class="nl">scopes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="l">write_products</span><span class="p">,</span><span class="l">write_customers</span><span class="p">,</span><span class="l">write_draft_orders</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>This will be parsed and adding to the Guice injection for you by Scalify. 
You can then access the ShopifyConfiguration by injecting it where needed:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">package</span> <span class="nn">controllers</span>

<span class="k">import</span> <span class="nn">javax.inject._</span>
<span class="k">import</span> <span class="nn">play.api._</span>
<span class="k">import</span> <span class="nn">play.api.mvc._</span>
<span class="k">import</span> <span class="nn">com.github.fulrich.scalify.ShopifyConfiguration</span>

<span class="nd">@Singleton</span>
<span class="k">class</span> <span class="nc">HomeController</span> <span class="nd">@Inject</span><span class="o">()(</span><span class="n">cc</span><span class="k">:</span> <span class="kt">ControllerComponents</span><span class="o">,</span> <span class="n">configuration</span><span class="k">:</span> <span class="kt">ShopifyConfiguration</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">AbstractController</span><span class="o">(</span><span class="n">cc</span><span class="o">)</span> <span class="o">{</span>
  
  <span class="k">def</span> <span class="nf">index</span><span class="o">()</span> <span class="k">=</span> <span class="nc">Action</span> <span class="o">{</span> <span class="k">implicit</span> <span class="n">request</span><span class="k">:</span> <span class="kt">Request</span><span class="o">[</span><span class="kt">AnyContent</span><span class="o">]</span> <span class="k">=&gt;</span>
    <span class="nc">Ok</span><span class="o">(</span><span class="n">s</span><span class="s">"Configuration scopes: ${configuration.scopes.mkString("</span><span class="o">,</span><span class="s">")}"</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="actions">Actions</h3>
<p>Play! Framework Controllers are made up of Actions. Actions process a Request into a Result.
Scalify provides some Actions to help you get straight to the coding your domain without needing to hassle with Shopify specific handling.</p>

<h4 id="hmac-action">HMAC Action</h4>
<p>The HMAC Action is probably the core and most useful action provided by Scalify.
The HMAC Action will process any request coming through and ensure it passed HMAC validation based upon your Shopify Configuration.
If validation passes your Action content will run if not error responses will be returned to the calling party.</p>

<p>An example of the HMAC action is below:</p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Singleton</span>
<span class="k">class</span> <span class="nc">HomeController</span> <span class="nd">@Inject</span><span class="o">()(</span><span class="n">cc</span><span class="k">:</span> <span class="kt">ControllerComponents</span><span class="o">,</span> <span class="n">hmacAction</span><span class="k">:</span> <span class="kt">HmacAction</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">AbstractController</span><span class="o">(</span><span class="n">cc</span><span class="o">)</span> <span class="o">{</span>
  
  <span class="k">def</span> <span class="nf">index</span><span class="o">()</span> <span class="k">=</span> <span class="n">hmacAction</span> <span class="o">{</span> <span class="k">implicit</span> <span class="n">request</span><span class="k">:</span> <span class="kt">HmacRequest</span><span class="o">[</span><span class="kt">AnyContent</span><span class="o">]</span> <span class="k">=&gt;</span>
    <span class="c1">// This will only be run if the HMAC validation was successful
</span>
    <span class="c1">// The HmacRequest includes the payload as a Scala URI Querystring
</span>    <span class="k">val</span> <span class="nv">queryString</span><span class="k">:</span> <span class="kt">QueryString</span> <span class="o">=</span> <span class="nv">request</span><span class="o">.</span><span class="py">payload</span>
    
    <span class="c1">// The HmacRequest also includes the original Play! Request
</span>    <span class="k">val</span> <span class="nv">originalRequest</span><span class="k">:</span> <span class="kt">Request</span><span class="o">[</span><span class="kt">AnyContent</span><span class="o">]</span> <span class="k">=</span> <span class="nv">request</span><span class="o">.</span><span class="py">request</span>
  
    <span class="nc">Ok</span><span class="o">(</span><span class="n">s</span><span class="s">"HMAC Validated!"</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h4 id="install-actions">Install Actions</h4>
<p>The OAuth installation process for Shopify Apps is usually one of the only barriers to entry to building your App.
Scalify aims to alleviate this by providing Actions that will simply the installation process.
Scalify provides two install actions. 
One for the initial install request and one for the callback request when the Merchant has authorized your application.</p>

<p>The install action will build on top of the HMAC Action and further parse the URI parameters into an InstallParameters object.</p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Singleton</span>
<span class="k">class</span> <span class="nc">InstallController</span> <span class="nd">@Inject</span><span class="o">()(</span><span class="n">cc</span><span class="k">:</span> <span class="kt">ControllerComponents</span><span class="o">,</span> <span class="n">actions</span><span class="k">:</span> <span class="kt">InstallActions</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">AbstractController</span><span class="o">(</span><span class="n">cc</span><span class="o">)</span> <span class="o">{</span>
  
  <span class="k">def</span> <span class="nf">index</span><span class="o">()</span> <span class="k">=</span> <span class="nv">actions</span><span class="o">.</span><span class="py">installAction</span> <span class="o">{</span> <span class="k">implicit</span> <span class="n">request</span><span class="k">:</span> <span class="kt">InstallRequest</span><span class="o">[</span><span class="kt">AnyContent</span><span class="o">]</span> <span class="k">=&gt;</span>
    <span class="c1">// This will only be run if the HMAC validation was successful and InstallParameters could be parsed
</span>
    <span class="c1">// The InstallRequest includes an InstallParameters class
</span>    <span class="k">val</span> <span class="nv">installParameters</span><span class="k">:</span> <span class="kt">InstallParameters</span> <span class="o">=</span> <span class="nv">request</span><span class="o">.</span><span class="py">parameters</span>
    
    <span class="c1">// The InstallRequest also includes a wrapped HmacRequest
</span>    <span class="k">val</span> <span class="nv">hmacRequest</span><span class="k">:</span> <span class="kt">HmacRequest</span><span class="o">[</span><span class="kt">AnyContent</span><span class="o">]</span> <span class="k">=</span> <span class="nv">request</span><span class="o">.</span><span class="py">request</span>
  
    <span class="nc">Ok</span><span class="o">(</span><span class="n">s</span><span class="s">"HMAC Validated and InstallParameters parsed!"</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>The authorize action will build on top of the HMAC Action and further parse the URI parameters into an AuthorizeConfirmation object.</p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Singleton</span>
<span class="k">class</span> <span class="nc">InstallController</span> <span class="nd">@Inject</span><span class="o">()(</span><span class="n">cc</span><span class="k">:</span> <span class="kt">ControllerComponents</span><span class="o">,</span> <span class="n">installActions</span><span class="k">:</span> <span class="kt">InstallActions</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">AbstractController</span><span class="o">(</span><span class="n">cc</span><span class="o">)</span> <span class="o">{</span>
  
  <span class="k">def</span> <span class="nf">index</span><span class="o">()</span> <span class="k">=</span> <span class="nv">actions</span><span class="o">.</span><span class="py">authorizeAction</span> <span class="o">{</span> <span class="k">implicit</span> <span class="n">request</span><span class="k">:</span> <span class="kt">AuthorizeRequest</span><span class="o">[</span><span class="kt">AnyContent</span><span class="o">]</span> <span class="k">=&gt;</span>
    <span class="c1">// This will only be run if the HMAC validation was successful and AuthorizeConfirmation could be parsed
</span>
    <span class="c1">// The InstallRequest includes an InstallParameters class
</span>    <span class="k">val</span> <span class="nv">authorizeConfirmation</span><span class="k">:</span> <span class="kt">AuthorizeConfirmation</span> <span class="o">=</span> <span class="nv">request</span><span class="o">.</span><span class="py">confirmation</span>
    
    <span class="c1">// The AuthorizeRequest also includes a wrapped HmacRequest
</span>    <span class="k">val</span> <span class="nv">hmacRequest</span><span class="k">:</span> <span class="kt">HmacRequest</span><span class="o">[</span><span class="kt">AnyContent</span><span class="o">]</span> <span class="k">=</span> <span class="nv">request</span><span class="o">.</span><span class="py">request</span>
  
    <span class="nc">Ok</span><span class="o">(</span><span class="n">s</span><span class="s">"HMAC Validated and AuthorizeConfirmation parsed!"</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/scalify/highlight/highlight.pack.js"></script><script>hljs.configure({languages:['scala','java','bash']});
hljs.initHighlighting();
              </script><script src="/scalify/js/main.js"></script></body></html>